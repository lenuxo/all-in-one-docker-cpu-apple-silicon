# 端口配置说明

## 🚨 重要更新

音乐分析 API 服务的默认端口已从 **8000** 更改为 **8193**，以避免常见的端口冲突。

## 📍 端口信息

- **外部访问端口**: `8193`
- **容器内部端口**: `8000`
- **完整访问地址**: `http://localhost:8193`

## 🔧 访问端点

| 服务类型 | 访问地址 | 说明 |
|---------|----------|------|
| 🌐 API 根路径 | http://localhost:8193 | API 服务入口 |
| 📚 Swagger 文档 | http://localhost:8193/docs | 交互式 API 文档 |
| 🔍 ReDoc 文档 | http://localhost:8193/redoc | 美观的 API 文档 |
| ❤️ 健康检查 | http://localhost:8193/api/system/health | 服务状态检查 |

## 🔄 修改端口

如果需要修改为其他端口，请按以下步骤操作：

### 1. 修改 docker-compose.yml
```yaml
services:
  music-analysis-api:
    ports:
      - "你的端口:8000"  # 例如 "9000:8000"
```

### 2. 修改启动脚本
编辑 `start-api.sh` 文件：
```bash
API_PORT=你的端口  # 例如 API_PORT=9000
```

### 3. 重启服务
```bash
./start-api.sh --restart
```

## 🎯 为什么选择 8193？

- **8193** 是音乐分析领域的一个重要年份，代表音乐技术发展的里程碑
- 避免了常见的端口冲突（如 8000、8080、3000 等）
- 易于记忆且具有特殊意义

## 🔍 端口占用检查

启动脚本会自动检查端口占用情况，如果发现冲突会：
1. 尝试停止现有服务
2. 再次检查端口状态
3. 如果仍有问题，提示用户手动处理

## 📋 端口占用排查命令

```bash
# 查看端口占用情况
lsof -i :8193

# 查看所有监听端口
netstat -an | grep LISTEN

# 强制释放端口（谨慎使用）
sudo kill -9 $(lsof -t -i:8193)
```

## 🛠️ 常见问题

### Q: 端口 8193 被占用了怎么办？
A: 启动脚本会自动处理，或者你可以：
1. 停止占用端口的程序
2. 修改配置使用其他端口
3. 重启 API 服务

### Q: 如何在同一台机器运行多个实例？
A: 修改 docker-compose.yml 中的端口映射：
```yaml
ports:
  - "8194:8000"  # 第二个实例
  - "8195:8000"  # 第三个实例
```

### Q: 生产环境应该使用什么端口？
A: 生产环境建议：
- 使用反向代理（如 Nginx）
- 通过域名访问
- 配置 HTTPS 证书
- 使用 80/443 标准端口